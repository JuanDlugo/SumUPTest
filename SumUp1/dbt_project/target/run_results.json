{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.17", "generated_at": "2024-07-24T22:59:00.963053Z", "invocation_id": "496fb18a-5449-4d59-b411-c2478ef492cb", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T22:58:59.508232Z", "completed_at": "2024-07-24T22:58:59.527786Z"}, {"name": "execute", "started_at": "2024-07-24T22:58:59.530170Z", "completed_at": "2024-07-24T22:59:00.238856Z"}], "thread_id": "Thread-1", "execution_time": 0.7385518550872803, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.sumup_project.avg_time_first_5_transactions", "compiled": true, "compiled_code": "WITH store_transactions AS (\n    SELECT\n        d.store_id,\n        t.happened_at,\n        ROW_NUMBER() OVER(PARTITION BY d.store_id ORDER BY t.happened_at) AS txn_number\n    FROM\n        SumUpTest1.transactions t\n    JOIN\n        SumUpTest1.devices d\n    ON\n        t.device_id = d.id\n    WHERE\n        t.status = 'accepted'\n),\nstore_first_5 AS (\n    SELECT\n        store_id,\n        MAX(happened_at) AS fifth_txn_time,\n        MIN(happened_at) AS first_txn_time\n    FROM\n        store_transactions\n    WHERE\n        txn_number <= 5\n    GROUP BY\n        store_id\n),\nstore_durations AS (\n    SELECT\n        store_id,\n        TIMESTAMPDIFF(DAY, first_txn_time, fifth_txn_time) AS duration_days\n    FROM\n        store_first_5\n    WHERE\n        EXISTS (\n            SELECT\n                1\n            FROM\n                store_transactions\n            WHERE\n                store_id = store_first_5.store_id\n            HAVING\n                COUNT(*) >= 5\n        )\n),\navg_time_per_store AS (\n    SELECT\n        store_id,\n        AVG(duration_days) AS avg_time_days\n    FROM\n        store_durations\n    GROUP BY\n        store_id\n)\nSELECT\n    'All Stores' AS store_id,\n    AVG(avg_time_days) AS avg_time_days\nFROM\n    avg_time_per_store", "relation_name": "`SumUpTest1`.`avg_time_first_5_transactions`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T22:59:00.254619Z", "completed_at": "2024-07-24T22:59:00.262903Z"}, {"name": "execute", "started_at": "2024-07-24T22:59:00.266024Z", "completed_at": "2024-07-24T22:59:00.399478Z"}], "thread_id": "Thread-1", "execution_time": 0.1521921157836914, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.sumup_project.avg_transacted_amount", "compiled": true, "compiled_code": "WITH store_typology_country AS (\n    SELECT s.typology, s.country, AVG(t.amount) AS average_amount\n    FROM SumUpTest1.transactions t\n    JOIN SumUpTest1.devices d ON t.device_id = d.id\n    JOIN SumUpTest1.stores s ON d.store_id = s.id\n    WHERE t.status = 'accepted'\n    GROUP BY s.typology, s.country\n)\nSELECT typology, country, average_amount\nFROM store_typology_country", "relation_name": "`SumUpTest1`.`avg_transacted_amount`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T22:59:00.414496Z", "completed_at": "2024-07-24T22:59:00.429320Z"}, {"name": "execute", "started_at": "2024-07-24T22:59:00.433283Z", "completed_at": "2024-07-24T22:59:00.565235Z"}], "thread_id": "Thread-1", "execution_time": 0.15779376029968262, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.sumup_project.pct_transactions_device_type", "compiled": true, "compiled_code": "WITH device_transactions AS (\n    SELECT\n        d.type AS device_type,\n        COUNT(*) AS transaction_count\n    FROM SumUpTest1.transactions t\n    JOIN SumUpTest1.devices d ON t.device_id = d.id\n    WHERE t.status = 'accepted'\n    GROUP BY d.type\n),\ntotal_transactions AS (\n    SELECT\n        COUNT(*) AS total_count\n    FROM SumUpTest1.transactions\n    WHERE status = 'accepted'\n)\nSELECT\n    dt.device_type,\n    dt.transaction_count,\n    (dt.transaction_count / tt.total_count) * 100 AS pct_transactions\nFROM device_transactions dt, total_transactions tt", "relation_name": "`SumUpTest1`.`pct_transactions_device_type`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T22:59:00.580424Z", "completed_at": "2024-07-24T22:59:00.593460Z"}, {"name": "execute", "started_at": "2024-07-24T22:59:00.596590Z", "completed_at": "2024-07-24T22:59:00.723468Z"}], "thread_id": "Thread-1", "execution_time": 0.14998412132263184, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.sumup_project.top_10_products", "compiled": true, "compiled_code": "WITH product_sales AS (\n    SELECT\n        t.product_name,\n        COUNT(*) AS total_sold\n    FROM SumUpTest1.transactions t\n    WHERE t.status = 'accepted'\n    GROUP BY t.product_name\n)\nSELECT\n    product_name,\n    total_sold\nFROM product_sales\nORDER BY total_sold DESC\nLIMIT 10", "relation_name": "`SumUpTest1`.`top_10_products`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T22:59:00.738973Z", "completed_at": "2024-07-24T22:59:00.747570Z"}, {"name": "execute", "started_at": "2024-07-24T22:59:00.751626Z", "completed_at": "2024-07-24T22:59:00.881011Z"}], "thread_id": "Thread-1", "execution_time": 0.14963984489440918, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.sumup_project.top_10_stores", "compiled": true, "compiled_code": "WITH store_transactions AS (\n    SELECT\n        s.name AS store_name,\n        SUM(t.amount) AS total_amount\n    FROM SumUpTest1.transactions t\n    JOIN SumUpTest1.devices d ON t.device_id = d.id\n    JOIN SumUpTest1.stores s ON d.store_id = s.id\n    WHERE t.status = 'accepted'\n    GROUP BY s.name\n)\nSELECT\n    store_name,\n    total_amount\nFROM store_transactions\nORDER BY total_amount DESC\nLIMIT 10", "relation_name": "`SumUpTest1`.`top_10_stores`"}], "elapsed_time": 1.891334056854248, "args": {"log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "cache_selected_only": false, "log_format": "default", "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "write_json": true, "vars": {}, "log_path": "/app/dbt_project/logs", "macro_debugging": false, "indirect_selection": "eager", "quiet": false, "select": [], "use_colors_file": true, "exclude": [], "partial_parse": true, "log_format_file": "debug", "show_resource_report": false, "use_colors": true, "invocation_command": "dbt run --profiles-dir /app/dbt_project --project-dir /app/dbt_project", "printer_width": 80, "which": "run", "defer": false, "favor_state": false, "profiles_dir": "/app/dbt_project", "print": true, "project_dir": "/app/dbt_project", "static_parser": true, "strict_mode": false, "populate_cache": true, "partial_parse_file_diff": true, "enable_legacy_logger": false, "require_explicit_package_overrides_for_builtin_materializations": false, "version_check": true, "log_level_file": "debug"}}